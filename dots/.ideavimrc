""" Plugins  --------------------------------

set surround
set commentary
set NERDTree
set highlightedyank

""" Handlers --------------------------------
sethandler <c-c> v-i:ide n:vim
sethandler <c-v> v-i:ide n:vim
sethandler <c-a-;> n:vim
sethandler <c-a-n> n:vim
sethandler <c-a-m> n:vim
sethandler <c-a-f> n:vim
sethandler <c-a-F> n:vim
sethandler <c-a-p> n:vim

""" Common settings -------------------------

set so=20  " Keep 10 lines above/below cursor
set nu
set relativenumber
set sneak
set clipboard+=unnamed
set clipboard+=ideaput
set ignorecase
set smartcase
set scrolloff=5
set wildignore+=*/target/*,*/.idea/*,*/.git/*,*/.svn/*,*/.hg/*,*/build/*
set ideastatusicon=gray
set ideamarks " Sync marks and idea bookmarks
set ideajoin
let mapleader=" "

nmap <leader>; :call Praise("IdeaVim")<CR>

function! Praise(name)
  echo a:name .. " is good"
endfunction

imap kj <Esc>

""" Window / Split Management ---------------
noremap <C-L> <C-W><C-L>
noremap <C-H> <C-W><C-H>
noremap <C-K> <C-W><C-K>
noremap <C-J> <C-W><C-J>

map <c-a-\> <Action>(SplitVertically)
map <c-a-/> <Action>(SplitHorizontally)
map <c-a-x> <Action>(Unsplit)
map <c-a-z> <Action>(UnsplitAll)

nnoremap <c-a-m> :action MoveEditorToOppositeTabGroup<CR>
nnoremap <c-a-n> :action EditSourceInNewWindow<CR>

nnoremap <c-a-f> :action GoToFile<CR>
nnoremap <c-a-o> :action GoToSymbol<CR>
nnoremap <c-a-p> :action SearchEverywhere<CR>

nnoremap <c-a-1> :action ActivateDebugToolWindow<CR>
nnoremap <c-a-2> :action ActivateRunToolWindow<CR>
nnoremap <c-a-3> :action ActivatePythonConsoleToolWindow<CR>
nnoremap <c-a-4> :action ActivateSciViewToolWindow<CR>
nnoremap <c-a-5> :action ActivateServicesToolWindow<CR>

nnoremap <c-a-6> :action ActivateCommitToolWindow<CR>
nnoremap <c-a-7> :action ActivateBookmarksToolWindow<CR>

nnoremap <c-a-q> :action HideAllWindows<CR>
nnoremap <c-a-w> :action HideActiveWindow<CR>
nnoremap <c-a-;> :action JumpToLastWindow<CR>


""" Mappings --------------------------------
nnoremap \ :NERDTree<CR>

map n nzzzv
map N Nzzzv
map j jzz
map k kzz

""" keep selection after visual indent
vnoremap < <gv
vnoremap > >gv

""" control binds 
vnoremap <C-j> <ESC>
map <C-k> :action SmartTypeCompletion<CR>
map <C-d> <C-d>zz
map <C-u> <C-u>zz

map <c-w> <Action>(CloseContent)

""" Tabs ------------------------------------
map <C-1> 1gt
map <C-2> 2gt
map <C-3> 3gt
map <C-4> 4gt
map <C-5> 5gt
map <C-6> 6gt
map <C-7> 7gt

map <c-n> <Action>(NextTab)
map <c-p> <Action>(PreviousTab)<CR>

""" gx LSP -----------------------------
map gn <Action>(GotoNextError)
map gp <Action>(GotoPreviousError)
map gh <Action>(ShowErrorDescription)
map gk <Action>(ShowIntentionActions)
map ge <Action>(EvaluateExpression)

map gi <Action>(GotoImplementation)
map gd <Action>(GotoDeclaration)
map gr <Action>(RenameElement)

map gs <Action>(ShowUsages)
map gf <Action>(Back)

""" Leader Key Mappings ----------------------
map <leader><leader> <Action>(ExecuteInPyConsoleAction)
vnoremap <leader>s y:%s/<C-r>"//gIc<Left><Left><Left><Left>

map <leader>o <Action>(OptimizeImports)
map <leader>r <Action>(ReformatCode)

map <leader>zo <Action>(ExpandAllRegions)
map <leader>zc <Action>(CollapseAllRegions)
map <leader>zr <Action>(ExpandRegion)
map <leader>zm <Action>(CollapseRegion)

map <leader>ff <action>(GotoFile)
map <leader>fr <action>(RecentFiles)
map <leader>fc <action>(FindInPath)

map <leader>ev :e ~/.ideavimrc<CR>


""" Run/Debug --------------------------------
map ,r <Action>(Run)
map ,R <Action>(Rerun)
map ,q <Action>(Stop)
map ,b <Action>(ToggleLineBreakpoint)
map ,n <Action>(MuteBreakpoints)

map ,a <Action>(ViewBreakpoints)
map ,s <Action>(StepOver)
map ,i <Action>(StepInto)
map ,o <Action>(StepOut)
map ,c <Action>(Resume)
map ,d <Action>(Debug)
